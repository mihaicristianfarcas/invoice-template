\documentclass[11pt,a4paper]{article}

% ================================================================================
% REQUIRED PACKAGES
% ================================================================================
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[sfdefault]{ClearSans}
\usepackage{geometry}
\usepackage{array}
\usepackage{booktabs}
\usepackage[table]{xcolor} % <- enables \rowcolors
\usepackage{eurosym}
\usepackage{xfp}
\usepackage{etoolbox}

% ================================================================================
% PAGE LAYOUT
% ================================================================================
\geometry{
    top=1.5cm,
    bottom=1.5cm,
    left=2.2cm,
    right=2.2cm,
    headheight=0pt,
    headsep=0pt,
    footskip=0.8cm
}

\renewcommand{\familydefault}{\sfdefault}
\pagestyle{empty}

% ================================================================================
% COLOR SCHEME - CUSTOMIZE THESE TO MATCH YOUR BRAND
% ================================================================================
\definecolor{primaryblue}{RGB}{44, 82, 130}
\definecolor{lightgray}{RGB}{128, 128, 128}
\definecolor{darkgray}{RGB}{64, 64, 64}
\definecolor{lightblue}{RGB}{248, 251, 255}

% ================================================================================
% CONFIGURATION SECTION - EDIT THESE VALUES FOR EACH INVOICE
% ================================================================================

% Client Information
\newcommand{\clientname}{Acme Corporation\\Ltd.}
\newcommand{\clientaddress}{123 Business Street\\12345 Commercial City}

% Your Company Information
\newcommand{\companyname}{Professional Services Inc.}
\newcommand{\companycif}{CIF: 12345678}
\newcommand{\companystreet}{456 Service Avenue}
\newcommand{\companycity}{Business Town, 54321}
\newcommand{\companyphone}{+1 (555) 123-4567}
\newcommand{\companyemail}{billing@professionalservices.com}

% Invoice Details
\newcommand{\invoicenumber}{INV-2024-0001}
\newcommand{\invoicedate}{January 15, 2024}
\newcommand{\invoicedeadline}{February 15, 2024}
\newcommand{\companyiban}{US12 3456 7890 1234 5678 90}
\newcommand{\companybic}{CHASUS33}

% Currency Settings
\newcommand{\currencysymbol}{\$}

% ================================================================================
% AUTOMATIC CALCULATION SYSTEM
% ================================================================================
\def\totalamount{0}

% Command to add two decimal numbers
\newcommand{\addtototal}[1]{%
    \xdef\totalamount{\fpeval{\totalamount + #1}}%
}

% Command to format currency
\newcommand{\formatcurrency}[1]{%
    \fpeval{round(#1, 2)}\,\currencysymbol%
}

% ================================================================================
% REUSABLE FORMATTING COMMANDS
% ================================================================================

% Spacing commands
\newcommand{\sectionskip}{\vspace{0.8cm}}
\newcommand{\itemskip}{\vspace{0.5cm}}
\newcommand{\blockskip}{\vspace{0.3cm}}
\newlength{\smallgap}
\setlength{\smallgap}{0.2cm}

% Text formatting
\newcommand{\layoutlabel}[1]{\textbf{\textcolor{lightgray}{\footnotesize\MakeUppercase{#1}}}}
\newcommand{\contactinfo}[1]{\textcolor{darkgray}{\small #1}}
\newcommand{\primarytext}[1]{\textcolor{primaryblue}{#1}}
\newcommand{\emphasizedtext}[1]{\textbf{\primarytext{#1}}}

% Section header
\newcommand{\sectionheader}[1]{%
    \noindent%
    {\Large\emphasizedtext{#1}}%
    \par\vspace{-0.2cm}%
    \noindent%
    \primarytext{\rule{\textwidth}{0.8pt}}%
    \blockskip%
}

% Contact block
\newcommand{\contactblock}[2]{%
    \layoutlabel{#1}\\[0.3cm]%
    {\large\textbf{#2}}%
}

% Invoice metadata (stacked)
\newcommand{\invoicemeta}[2]{%
    \layoutlabel{#1} \\[0.1cm] \textbf{#2}%
}

% Invoice metadata (inline, no line breaks)
\newcommand{\invoicemetainline}[2]{%
    \layoutlabel{#1}: \textbf{#2}%
}

% ================================================================================
% SERVICE MANAGEMENT SYSTEM
% ================================================================================

% Initialize services table (striped rows)
\newcommand{\startservicestable}{%
    \rowcolors{2}{lightblue}{}%
    \begin{tabular}{p{8.6cm} c c r}
        \emphasizedtext{Service Description} & 
        \emphasizedtext{Qty/Hours} & 
        \emphasizedtext{Rate (\currencysymbol)} & 
        \emphasizedtext{Total (\currencysymbol)} \\
        \midrule
}

% End services table
\newcommand{\finishservicestable}{%
    \end{tabular}%
    \rowcolors{0}{}{}%
}

% Add service
\newcommand{\newservice}[3]{%
    #1 & #2 & \formatcurrency{#3} & \formatcurrency{\fpeval{#2 * #3}}\\
    \addtototal{\fpeval{#2 * #3}}%
}

% Display total
\newcommand{\displaytotal}{%
    \begin{flushright}
        \begin{tabular}{lr}
            \large\emphasizedtext{TOTAL AMOUNT DUE:} & 
            {\Large\emphasizedtext{\formatcurrency{\totalamount}}} \\
        \end{tabular}
    \end{flushright}
}

% ================================================================================
% DOCUMENT CONTENT
% ================================================================================

\begin{document}

% Header
\noindent
\begin{minipage}[t]{0.47\textwidth}
    \contactblock{from}{\companyname}\\[\smallgap]
    \contactinfo{\companystreet}\\
    \contactinfo{\companycity}\\[0.3cm]
    \contactinfo{\companyphone}\\
    \contactinfo{\texttt{\companyemail}}
\end{minipage}%
\hfill%
\begin{minipage}[t]{0.47\textwidth}
    \begin{flushright}
        \contactblock{to}{\clientname}\\[\smallgap]
        \contactinfo{\clientaddress}
    \end{flushright}
\end{minipage}

\sectionskip

% Invoice title
\begin{center}
    {\Huge\emphasizedtext{INVOICE}}
\end{center}

\blockskip

% Invoice metadata (inline, one row, spaced L-C-R)
\noindent
\begin{center}
    \begin{tabular*}{\textwidth}{@{\extracolsep{\fill}}ccc@{}}
        \layoutlabel{Invoice Number} & \layoutlabel{Invoice Date} & \layoutlabel{Payment Due} \\
        \textbf{\invoicenumber} & \textbf{\invoicedate} & \textbf{\invoicedeadline} \\
    \end{tabular*}
\end{center}

\sectionskip

% Services section
\sectionheader{Services Provided}

\startservicestable
    \newservice{Technical consultation and code review}{8}{75.00}
    \newservice{Database optimization and performance tuning}{12}{85.00}
    \newservice{Custom PostgreSQL extension development}{1}{500.00}
    \newservice{System architecture documentation}{10}{65.00}
    \newservice{Training session for development team}{6}{90.00}
    \newservice{Project management and coordination}{5}{120.00}
    \newservice{Code refactoring and optimization}{10}{70.00}
\finishservicestable

\blockskip

% Total amount
\displaytotal

\blockskip

% Payment information
\sectionheader{Payment Information}

\begin{tabular}{@{}p{3cm}l@{}}
    \layoutlabel{IBAN} & \texttt{\textbf{\companyiban}} \\[\smallgap]
    \layoutlabel{BIC/SWIFT} & \texttt{\textbf{\companybic}} \\[\smallgap]
\end{tabular}

\itemskip

% Notes
\sectionheader{Notes}

\textcolor{darkgray}{%
\small Thank you! Please include the invoice number \textbf{\invoicenumber} in your payment reference.}

\sectionskip

% Footer
\begin{center}
    {\small\textcolor{lightgray}{%
        \textbf{\companyname} \\ \textbf{\companycif} \\ \companystreet \\ \companycity \\ \companyphone \\ \texttt{\companyemail}
    }}
\end{center}

\end{document}
